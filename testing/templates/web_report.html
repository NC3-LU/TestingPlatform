{% if result %}

<script>
  let countGood = 0;
  let countBad = 0;
  let countWarning = 0;
  let countTotal = 0;


</script>
<section class="col-lg-11 row my-5 border border-2 rounded p-4">

  <h1 class="text-center">Overview of {{ domain_name }}</h1>
  <div class="row justify-content-evenly mb-5">
    <div class="col-lg-3 d-flex align-items-center">
      <canvas id="chart1"></canvas>
    </div>
    <!--<div class="col-lg-6 d-flex align-items-center">
      <canvas id="chart2"></canvas>
    </div>-->
  </div>
  <div class="row justify-content-between">
    <div class="col-lg-7">
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.content_security_policy.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.content_security_policy.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.cookies.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.cookies.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.cross_origin_resource_sharing.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.cross_origin_resource_sharing.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.redirection.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.redirection.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.referrer_policy.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.referrer_policy.score_description }} (optional)
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.strict_transport_security.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.strict_transport_security.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.subresource_integrity.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.subresource_integrity.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.x_content_type_options.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.x_content_type_options.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.x_frame_options.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.x_frame_options.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if result.x_xss_protection.pass %}
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% else %}
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ result.x_xss_protection.score_description }}
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if nameservers_comments.grade == "full" %}
          <script> countGood++;countTotal++;</script>
          <i class="bi bi-check-circle-fill color-success"> </i>
          {% elif nameservers_comments.grade == "null" %}
          <script>countBad++;countTotal++;</script>
          <i class="bi bi-x-circle-fill color-danger"></i>
          {% endif %}
          {{ nameservers_comments.comment }} (IPv6)
        </div>
      </div>
      <div class="row my-1">
        <div class="col-lg-12 fs-4">
          {% if record.2 %}
          <script> countGood++;countTotal++;</script>
          <i class="bi bi-check-circle-fill color-success"></i>
          Your server has an IPv6 address.
          {% else %}
          <script>countBad++;countTotal++;</script>
          <i class="bi bi-x-circle-fill color-danger"></i>
          Your server does not have an IPv6 address.
          {% endif %}
          (IPv6)
        </div>

      </div>
      <!-- -- -->
    </div>
    <div class="col-lg-3">
      <h1>Test Discovery</h1>
      <div class="row my-4">
        <div class="col-lg-6 fs-2">Good</div>
        <div class="col-lg-6"><span id="good-count"
                                    class="rounded-circle p-2 fs-4 text-white"
                                    style="background:#71cdba;"></span>
        </div>
      </div>
      <div class="row my-4">
        <div class="col-lg-6 fs-2">Vulnerable</div>
        <div class="col-lg-6"><span id="vulnerable-count"
                                    class="rounded-circle p-2 fs-4 text-white"
                                    style=" background:#ff5c5c;">
        </span>
        </div>
      </div>
      <!--<div class="row my-4">
        <div class="col-lg-6 fs-2">Warning</div>
        <div class="col-lg-6"><span class="rounded-circle p-2 fs-4 text-black"
                                    style="background:#f5e230;">10</span>
        </div>
      </div>
      <div class="row my-4">
        <div class="col-lg-6 fs-2">Informational</div>
        <div class="col-lg-6"><span class="rounded-circle p-2 fs-4 text-white"
                                    style="background:#2475e8;">10</span>
        </div>
      </div>-->
    </div>
  </div>
</section>
<script>
    const result = parseInt({{ scan_summary.tests_quantity }} + countTotal - 1) - parseInt({{ scan_summary.tests_passed }} + countGood - 1);

     document.getElementById('vulnerable-count').innerHTML = '&nbsp;' + result + '&nbsp;' ;
     document.getElementById('good-count').innerHTML = '&nbsp;' + parseInt({{ scan_summary.tests_passed }} + countGood - 1) + '&nbsp;' ;



</script>
<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.content_security_policy.pass %}
      <i class="bi bi-check-circle-fill color-success"> </i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.content_security_policy.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Content Security Policy (CSP) is an HTTP header that allows site operators
        fine-grained control over where resources on their site can be loaded from. The
        use of this header is the best method to prevent cross-site scripting (XSS)
        vulnerabilities. Due to the difficulty in retrofitting CSP into existing
        websites, CSP is mandatory for all new websites and is strongly recommended for
        all existing high-risk sites.</p>
    </div>
    {% if result.content_security_policy.data %}
    <div class="row my-2">
      <button type="button" data-bs-toggle="collapse" data-bs-target="#target1"
              aria-expanded="false" aria-controls="collapseExample"
              class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
        <i style="color: #4ecb71 !important;"
           class="p-2 rounded-circle bi bi-chevron-right bg-white me-3"></i>
        Current CSP
      </button>

      <div class="p-0 collapse" id="target1">
        <div class="p-3 border-bottom border-end border-start">
          The current set CSP is the following:
          <code>
            Content-Security-Policy
          </code>
        </div>
      </div>
    </div>
    {% endif %}
    <div class="row my-2">
      <button type="button" data-bs-toggle="collapse" data-bs-target="#target2"
              aria-expanded="false" aria-controls="collapseExample"
              class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
        <i
          class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
        How to implement the CSP?
      </button>

      <div class="p-0 collapse" id="target2">
        <div class="p-4 border-bottom border-end border-start">
          <p>Determine what types of resources your site should load: Before
            implementing
            CSP, it is important to identify which types of resources your site needs to
            load such as scripts, stylesheets, images, and fonts.</p>
          <p><b>Create a whitelist of
            allowed sources:</b><br> Once you have determined the types of
            resources your site needs to load, you should create a whitelist of allowed
            sources for each of them. This will prevent malicious sources from injecting
            unwanted code into your site.</p>

          <p><b>Use the Content-Security-Policy header:</b><br>Add the
            Content-Security-Policy
            header
            to the HTTP response of your site. This header specifies the whitelist of
            allowed sources for each resource type.</p>
          <p>For example, the following header
            specifies that only resources from the same origin as the site are allowed:
          </p>
          <ul>
            <li><b>Content-Security-Policy: default-src 'self'</b></li>
          </ul>
          <p><b>Test your CSP policy:</b> <br>After implementing your CSP policy, it is
            important
            to
            test it to ensure that it does not break any functionality of your site. You
            can use rescan and check if the CSP will pass.</p>
          <p><b>Keep your CSP policy up to date:</b><br> As your site evolves, you may
            need to add
            new
            resources or change the sources of existing resources. Therefore, it is
            important to review and update your CSP policy regularly to ensure that it
            remains effective.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.cookies.pass %}
      <i class="bi bi-check-circle-fill color-success"> </i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.cookies.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Using cookies attributes such as Secure and HttpOnly can protect users from
        having their personal information stolen.</p>
    </div>
  </div>
  {% if result.cookies.output.data %}
  <div class="row my-2">
    <button type="button" data-bs-toggle="collapse" data-bs-target="#cookies-found"
            aria-expanded="false" aria-controls="collapseExample"
            class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
      <i class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
      Cookies found
    </button>

    <div class="p-0 collapse" id="cookies-found">
      <div class="p-3 border-bottom border-end border-start">
        <div class="table-responsive">
          {% for cookie_key, cookie_value in result.cookies.output.data.items %}
          <h3>Cookie: {{ cookie_key }}</h3>
          <ul>
            {% for attribute_key, attribute_value in cookie_value.items %}
            {% if attribute_key == "secure" and not attribute_value or attribute_key ==
            "httponly" and not attribute_value %}
            <li class="text-danger fw-bold">{{ attribute_key }}: {{ attribute_value }}
            </li>
            {% else %}
            <li>{{ attribute_key }}: {{ attribute_value }}</li>
            {% endif %}
            {% endfor %}
          </ul>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>
  {% endif %}
  <div class="row my-2">
    <button type="button" data-bs-toggle="collapse"
            data-bs-target="#cookie-recommendation"
            aria-expanded="false" aria-controls="collapseExample"
            class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
      <i
        class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
      Recommendation
    </button>

    <div class="p-0 collapse" id="cookie-recommendation">
      <div class="p-4 border-bottom border-end border-start">
        <p>The <b>secure flag</b> in cookies tells the browser that the cookie should
          only be sent
          over HTTPS, which is an encrypted connection. This helps to protect the cookie
          from being intercepted by attackers. If a website never uses HTTPS, the secure
          flag will not offer any protection.</p>

        <p>The <b>HttpOnly flag</b> tells the browser that the cookie should only be
          accessible by
          the server. This helps to mitigate XSS attacks, where an attacker tries to
          steal
          cookies by injecting malicious scripts into a web page.</p>

        <p>The <b>SameSite flag</b> controls when cookies are sent. When it is set to
          Strict, the
          cookie is only sent if the site for the cookie matches the site currently
          shown
          in the browser's URL bar. This helps to mitigate CSRF attacks, where an
          attacker
          tricks a user into submitting a malicious form on a trusted site.</p>

        <p>You should also set an <b>expiration date</b> for your cookies. Without one,
          the cookie
          will last as long as the browser session does. By setting an expiration date,
          you can limit how long the cookie persists.</p>
        <p>Here are some additional tips for securing cookies:</p>
        <ul>
          <li>Use short expiration dates for cookies that store sensitive data.</li>
          <li>Do not store passwords or other sensitive data in cookies.</li>
          <li>Use a secure cookie storage mechanism.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.cross_origin_resource_sharing.pass %}
      <i class="bi bi-check-circle-fill color-success"> </i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.cross_origin_resource_sharing.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Cross-Origin Resource Sharing (CORS) is an HTTP-header based mechanism that
        allows a server to indicate any origins (domain, scheme, or port) other than its
        own from which a browser should permit loading resources. CORS also relies on a
        mechanism by which browsers make a "preflight" request to the server hosting the
        cross-origin resource, in order to check that the server will permit the actual
        request. In that preflight, the browser sends headers that indicate the HTTP
        method and headers that will be used in the actual request.</p>
    </div>
  </div>
  <div class="row my-2">
    <button type="button" data-bs-toggle="collapse"
            data-bs-target="#cors-recommendation"
            aria-expanded="false" aria-controls="collapseExample"
            class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
      <i
        class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
      Recommendation
    </button>

    <div class="p-0 collapse" id="cors-recommendation">
      <div class="p-4 border-bottom border-end border-start">
        <b>Specify origins</b>

       <p> Instead of using the wildcard <code>"*"</code>, explicitly specify the allowed origins for
        cross-origin requests.
        This can be done by setting the Access-Control-Allow-Origin header to a specific
        origin, such as <code>https://nc3.lu</code>, or to a list of trusted origins.
        By explicitly specifying the allowed origins, you can prevent unauthorized
        access to your resources from untrusted sources.</p>

        <b>Restrict methods and headers</b>

        Use the Access-Control-Allow-Methods and Access-Control-Allow-Headers headers to
        define the allowed HTTP methods and request headers for cross-origin requests.
        Only include the necessary methods and headers that your application requires,
        rather than allowing all methods or headers.
        This can help to reduce the attack surface of your application and protect it
        from malicious requests.
        Validate origin

        Implement server-side validation of the Origin header in the request to ensure
        that it matches the list of allowed origins.
        This prevents attackers from spoofing the origin and bypassing CORS
        restrictions.
        You can use the nginx web server to implement this validation by adding the
        following line to your nginx.conf file:
        <code>
        add_header Access-Control-Allow-Origin $http_origin;
        </code>

        Use credentials carefully

        Be cautious when enabling the Access-Control-Allow-Credentials header.
        Only enable it if your application requires sending and receiving credentials
        (e.g., cookies, authorization headers) across origins.
        Make sure to properly handle and validate the credentials on the server-side to
        prevent unauthorized access.
        Apply origin whitelisting

        Consider maintaining a whitelist of trusted origins within your application's
        server-side logic.
        Validate incoming requests against this whitelist and only allow requests from
        trusted origins.
        This can help to further reduce the attack surface of your application and
        protect it from malicious requests.
        Set secure CORS headers

        In addition to the CORS headers, ensure that your application implements other
        security headers, such as Content Security Policy (CSP), Strict Transport
        Security (HSTS), and X-Frame-Options, to provide a layered security approach.
        These headers can help to protect your application from a variety of attacks,
        including cross-site scripting (XSS), clickjacking, and man-in-the-middle (MITM)
        attacks.
        The above text is truthful and accurate. It is based on the best practices for
        implementing CORS headers, as recommended by security experts and industry
        standards. By following these best practices, you can help to protect your
        application from cross-origin attacks.
      </div>
    </div>
  </div>
</section>
<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.redirection.pass %}
      <i class="bi bi-check-circle-fill color-success"></i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.redirection.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Properly configured redirections from HTTP to HTTPS allow browsers to correctly
        apply HTTP Strict Transport Security (HSTS) settings.</p>
    </div>
  </div>
</section>

<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.referrer_policy.pass %}
      <i class="bi bi-check-circle-fill color-success"></i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.referrer_policy.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Referrer Policy can protect the privacy of your users by restricting the
        contents of the HTTP Referer header.</p>
    </div>
    <div class="row my-2">
      <button type="button" data-bs-toggle="collapse" data-bs-target="#referrer-policy"
              aria-expanded="false" aria-controls="collapseExample"
              class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
        <i class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
        How to set the referrer policy and what to set?
      </button>

      <div class="p-0 collapse" id="referrer-policy">
        <div class=" p-3 border-bottom border-end border-start">
          <p>You can set the header in an apache configuration file or in a
            root web directory over an <code>.htaccess</code> file.</p>

          <p>You need to add:<br>
            <code>Header set Referrer-Policy <b>"replace-with-the-policy-you-want-to-use"</b></code>
          </p>
          <div class="col-lg-6">
            <h4>What policies do exist?</h4>
            <ul>
              <li><b>"no-referrer"</b>- Do not send the referrer header.</li>
              <li><b>"no-referrer-when-downgrade"</b> - Send the referrer header only
                when
                the referring page is using HTTPS.
              </li>
              <li><b>"same-origin"</b>- Send the referrer header only when the referring
                page is from the same origin (same domain and protocol).
              </li>
              <li><b>"strict-origin"</b> - Send the referrer header only when the
                referring page is from the same origin, and only include the origin, not
                the full URL.
              </li>
              <li><b>"strict-origin-when-cross-origin"</b> - Send the referrer header
                only
                when the referring page is from the same origin, and only include the
                origin when the referring page is from a different origin.
              </li>
              <li><b>"unsafe-url"</b> - Always send the full URL in the referrer header,
                even when the referring page is from a different origin.
              </li>
            </ul>
            <h4>Which one to use?</h4>
            <p>
              If your website doesn't need to send any referrer information to other
              domains, you can use the <code>"no-referrer"</code> directive. This will
              prevent the
              browser from sending any referrer information in the HTTP header.</p>

            <p>If your website needs to send referrer information only when the user is
              navigating within your own domain, you can use the
              <code>"same-origin"</code> directive.
              This will prevent the browser from sending referrer information when the
              user navigates to a different domain.</p>

            <p>If your website needs to send referrer information to other domains, but
              you
              don't want to leak sensitive information, you can use the
              <code>"strict-origin-when-cross-origin"</code> directive. This will send
              the referrer
              information only when the referring page is from the same origin, and will
              only include the origin (not the full URL) when the referring page is from
              a
              different origin.</p>

            <p>If your website needs to send referrer information to other domains, and
              you
              don't need to hide the URL of the referring page, you can use the "origin"
              or <code>"unsafe-url"</code> directive. The <code>"origin"</code>
              directive will send only the origin
              (not the full URL) in the referrer header, while the
              <code>"unsafe-url"</code> directive
              will send the full URL of the referring page.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      {% if result.subresource_integrity.pass %}
      <i class="bi bi-check-circle-fill color-success"> </i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %} {{ result.subresource_integrity.score_description}}
    </div>
    <div class="col-lg-12 fs-4">
      <p>Subresource Integrity (SRI) is a security feature that enables browsers to
        verify that files they fetch (for example, from a CDN)
        are delivered without unexpected manipulation. It works by allowing you to
        provide a cryptographic hash that a fetched file must match.
      </p>
    </div>
  </div>
  {% if result.subresource_integrity.output.data %}
  <div class="row my-2">
    <button type="button" data-bs-toggle="collapse"
            data-bs-target="#subresource_integrity"
            aria-expanded="false" aria-controls="collapseExample"
            class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
      <i class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
      Subresource Integrity (SRI)
    </button>

    <div class="p-0 collapse" id="subresource_integrity">
      <div class="p-3 border-bottom border-end border-start">


      </div>
    </div>
  </div>
  {% endif %}
</section>
<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      <i class="bi bi-database-fill-gear text-warning"></i> Server Headers
    </div>
  </div>
  <div class="row my-2">
    <table class="table table-light table-bordered table-striped">
      <tr>
        <th>Header</th>
        <th>Value</th>
      </tr>
      <tr>
        <td>Accept-Ranges</td>
        <td>{{ headers.Accept_Ranges }}</td>
      </tr>
      <tr>
        <td>Connection</td>
        <td>{{ headers.Connection }}</td>
      </tr>
      <tr>
        <td>Content-Encoding</td>
        <td>{{ headers.Content_Encoding }}</td>
      </tr>
      <tr>
        <td>Content-Length</td>
        <td>{{ headers.Content_Length}}</td>
      </tr>
      <tr>
        <td>Content-Security-Policy</td>
        {% if headers.Content_Security_Policy %}
        <td>{{ headers.Content_Security_Policy}}</td>
        {% else %}
        <td class="bg-danger fw-bold">Not implemented</td>
        {% endif %}
      </tr>
      <tr>
        <td>Content-Type</td>
        <td>{{ headers.Content_Type}}</td>
      </tr>
      <tr>
        <td>Date</td>
        <td>{{ headers.Date}}</td>
      </tr>
      <tr>
        <td>ETag</td>
        <td>{{ headers.ETag}}</td>
      </tr>
      <tr>
        <td>Keep-Alive</td>
        <td>{{ headers.Keep_Alive}}</td>
      </tr>
      <tr>
        <td>Last-Modified</td>
        <td>{{ headers.Last_Modified}}</td>
      </tr>
      <tr>
        <td>Permissions-Policy</td>
        <td>{{ headers.Permissions_Policy}}</td>
      </tr>
      <tr>
        <td>Referrer-Policy</td>
        <td>{{ headers.Referrer_Policy}}</td>
      </tr>
      <tr>
        <td>Server</td>
        <td>{{ headers.Server}}</td>
      </tr>
      <tr>
        <td>Strict-Transport-Security</td>
        <td>{{ headers.Strict_Transport_Security}}</td>
      </tr>
      <tr>
        <td>Vary</td>
        <td>{{ headers.Vary}}</td>
      </tr>
      <tr>
        <td>X-Content-Type-Options</td>
        <td>{{ headers.X_Content_Type_Options}}</td>
      </tr>
    </table>
  </div>
</section>

<script>
  /*const ctx2 = document.getElementById('chart2').getContext('2d');

  const data2 = {
    datasets: [{
      label: 'Blue Dataset',
      data: [
        {x: 1, y: 3},
        {x: 2, y: 7},
        {x: 3, y: 5},
      ],
      backgroundColor: 'rgba(75, 192, 192, 0.5)',
      borderColor: 'rgba(75, 192, 192, 1)',
      borderWidth: 1,
    }, {
      label: 'Red Dataset',
      data: [
        {x: 4, y: 8},
        {x: 5, y: 2},
        {x: 6, y: 1},
      ],
      backgroundColor: 'rgba(255, 99, 132, 0.5)',
      borderColor: 'rgba(255, 99, 132, 1)',
      borderWidth: 1,
    }, {
      label: 'Orange Dataset',
      data: [
        {x: 7, y: 6},
        {x: 8, y: 9},
        {x: 9, y: 4},
      ],
      backgroundColor: 'rgba(255, 159, 64, 0.5)',
      borderColor: 'rgba(255, 159, 64, 1)',
      borderWidth: 1,
    }]
  };

  const options2 = {
    scales: {
      x: {
        type: 'linear',
        position: 'bottom',
      }
    }
  };

  const myChart2 = new Chart(ctx2, {
    type: 'scatter',
    data: data2,
    options: options2
  });*/







</script>
<script>
  const total = {{ scan_summary.tests_quantity }} -1;
  const totalGood = {{ scan_summary.tests_passed }} -1;
  let successPercentage = totalGood / total * 100;
  let failurePercentage = 100 - successPercentage;

  var data = [{
    data: [successPercentage, failurePercentage],
    backgroundColor: [
      "#4ecb71",
      "#ff5c5c",
    ],
    borderColor: "#fff"
  }];

  var options = {
    tooltips: {
      enabled: false
    },
    plugins: {
       datalabels: {
            formatter: (value, ctx) => {
                let sum = 0;
                let dataArr = ctx.chart.data.datasets[0].data;
                dataArr.map(data => {
                    sum += data;
                });
                let percentage = (value*100 / sum).toFixed(2)+"%";
                return percentage;
            },
            color: '#fff',
        },
        title: {
      display: true,
      text: 'Score'
    }
    },

  };

  var ctx = document.getElementById("chart1").getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
      datasets: data
    },
    options: options
  });







</script>

{% endif %}
<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">

      {% if nameservers_comments.grade == "full" and records_v6_comments.grade == "full"
      %}
      <i class="bi bi-check-circle-fill color-success"> </i>
      {% else %}
      <i class="bi bi-x-circle-fill color-danger"></i>
      {% endif %}
      IPv6
    </div>
    <div class="col-lg-12 fs-4">
      <p>IPv6 is the latest version of the Internet Protocol that assigns unique
        identifiers to devices on the internet and routes internet traffic. It provides
        a much larger address space than IPv4, facilitating the connection of more
        devices to the internet. Benefits of IPv6 include enhanced security, improved
        routing efficiency, simplified network configuration.</p>
      <div class="row my-2">
        {% if nameservers_comments.grade == "full" %}
        <button type="button" data-bs-toggle="collapse" data-bs-target="#ipv6-domain"
                aria-expanded="false" aria-controls="collapseExample"
                class="btn p-3 fs-2 fw-bold text-start text-light bg-success">
          <i
            class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
          IPv6 Nameserver Check
        </button>

        {% elif nameservers_comments.grade == "null" %}
        <button type="button" data-bs-toggle="collapse" data-bs-target="#ipv6-domain"
                aria-expanded="false" aria-controls="collapseExample"
                class="btn p-3 fs-2 fw-bold text-start text-light bg-danger">
          <i
            class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
          IPV6 Nameserver Check
        </button>

        {% endif %}

        <div class="p-0 collapse" id="ipv6-domain">
          <div class="p-4 border-bottom border-end border-start">
            <h1 class="text-center">IPv6 Test Results</h1>
            <div class="col-lg-6 col-md-5 mb-2 text-left fs-5 ">
              <p>Name Servers:</p>
              <p>
                {% if nameservers_comments.grade == "full"%}
                <i class="bi bi-check-circle-fill color-success"> </i>
                {% elif nameservers_comments.grade == "full" %}
                <i class="bi bi-exclamation-circle-fill color-warning"></i>
                {% elif nameservers_comments.grade == "null" %}
                <i class="bi bi-x-circle-fill color-danger"></i>
                {% endif %}
                {{ nameservers_comments.comment }}
              </p>
              <table class="table table-light table-bordered table-striped">
                <tr>
                  <th>Name</th>
                  <th>Address (v4)</th>
                  <th>Reachable (v4)</th>
                  <th>Address (v6)</th>
                  <th>Reachable (v6)</th>
                </tr>
                {% for nameserver, ns in nameservers.items %}
                <tr>
                  <td>{{ nameserver }}</td>
                  <td>{{ ns.ipv4.address }}</td>
                  <td>
                    {{ ns.ipv4.reachable }}
                    {% if ns.ipv4.reachable %}
                    <i class="bi bi-check-circle-fill color-success"> </i>
                    {% else %}
                    <i class="bi bi-x-circle-fill color-danger"></i>
                    {% endif %}
                  </td>
                  <td>{{ ns.ipv6.address }}</td>
                  <td>
                    {{ ns.ipv6.reachable }}
                    {% if ns.ipv6.reachable %}
                    <i class="bi bi-check-circle-fill color-success"> </i>
                    {% else %}
                    <i class="bi bi-x-circle-fill color-danger"></i>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </table>
              <p>
                {% if nameservers_reachability_comments.grade == "full" %}
                <i class="bi bi-check-circle-fill color-success"> </i>
                {% elif nameservers_reachability_comments.grade == "null" %}
                <i class="bi bi-x-circle-fill color-danger"></i>
                {% endif %}
                {{ nameservers_reachability_comments.comment }}
              </p>

              <p>
                {% if records_v6_comments.grade == "full" %}
                <i class="bi bi-check-circle-fill color-success"> </i>
                {% elif records_v6_comments.grade == "null" %}
                <i class="bi bi-x-circle-fill color-danger"></i>
                {% endif %}
                {{ records_v6_comments.comment }}
              </p>

            </div>
          </div>
        </div>
      </div>
      <div class="row my-2">
        {% if records_v6_comments.grade == "full" %}
        <button type="button" data-bs-toggle="collapse"
                data-bs-target="#ipv6-mailserver"
                aria-expanded="false" aria-controls="collapseExample"
                class="btn p-3 fs-2 fw-bold text-start text-light bg-success">
          <i
            class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
          IPv6 Webserver Check
        </button>

        {% elif records_v6_comments.grade == "null" %}
        <button type="button" data-bs-toggle="collapse"
                data-bs-target="#ipv6-mailserver"
                aria-expanded="false" aria-controls="collapseExample"
                class="btn p-3 fs-2 fw-bold text-start text-light bg-danger">
          <i
            class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
          IPV6 Webserver Check
        </button>

        {% endif %}

        <div class="p-0 collapse" id="ipv6-mailserver">
          <div class="p-4 border-bottom border-end border-start">
            <h1 class="text-center">IPv6 Test Results</h1>
            <div class="col-lg-6 col-md-5 mb-2 text-left fs-5 ">

              <p>Records:</p>
              {% if records %}
              <table class="table table-light table-bordered table-striped">
                <tr>
                  <th>Server</th>
                  <th>IPv4</th>
                  <th>IPv6</th>
                </tr>
                {% for record in records %}
                <tr>
                  <td>{{ record.0 }}</td>
                  <td>{{ record.1 }}</td>
                  <td>{{ record.2 }}</td>
                </tr>
              </table>
              {% if record.2 %}
              <p>
                <i class="bi bi-check-circle-fill color-success"></i>
                Your server has an IPv6 address.
              </p>
              {% else %}
              <p>
                <i class="bi bi-x-circle-fill color-danger"></i>
                Your server does not have an IPv6 address.
              </p>
              {% endif %}

              {% endfor %}
              {% endif %}
              <p>
                {% if records_v4_comments.grade == "full" %}
                <i class="bi bi-check-circle-fill color-success"> </i>
                {% elif records_v4_comments.grade == "null" %}
                <i class="bi bi-x-circle-fill color-danger"></i>
                {% endif %}
                {{ records_v4_comments.comment }}
              </p>
              <p>
                {% if records_v6_comments.grade == "full" %}
                <i class="bi bi-check-circle-fill color-success"> </i>
                {% elif records_v6_comments.grade == "null" %}
                <i class="bi bi-x-circle-fill color-danger"></i>
                {% endif %}
                {{ records_v6_comments.comment }}
              </p>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="col-lg-11 row my-5 border border-2 rounded p-4">
  <div class="row">
    <div class="col-lg-12 fs-1 fw-bold">
      TLS Results
    </div>
    <div class="col-lg-12 fs-4">
      Transport Layer Security (TLS) is a cryptographic protocol that protects data in
      transit over a network. It does this by establishing a secure channel between two
      communicating applications, using a handshake process to agree on the protocol
      version, cryptographic algorithms, and exchange cryptographic keys. This ensures
      that the data is confidential, authentic, and integral, protecting against
      eavesdropping, tampering, or message forgery.
    </div>
  </div>
  {% if tls_results %}

  {% for version, info in tls_results.items %}

  <div class="row my-2">
    <button type="button" data-bs-toggle="collapse"
            data-bs-target="#tls-found-{{ forloop.counter }}"
            aria-expanded="false" aria-controls="collapseExample"
            class="btn p-3 fs-2 fw-bold text-start text-light bg-info">
      <i class="p-2 rounded-circle bi bi-chevron-right bg-white me-3 text-black"></i>
      {{ version }}
    </button>

    <div class="p-0 collapse" id="tls-found-{{ forloop.counter }}">
      <div class="p-3 border-bottom border-end border-start">
        {% if version == "least_strength" %}
        <p>Least Strength: {{ info }}</p>
        {% else %}
        <ul>
          {% for item in info %}
          <li>
            <p>Key Exchange Info: {{ item.kex_info }}</p>
            <p>Name: {{ item.name }}</p>
            <p>Strength: {{ item.strength }}</p>
          </li>
          {% endfor %}
        </ul>
        {% endif %}
      </div>
    </div>
  </div>

  {% endfor %}
  {% endif %}
</section>


<script>
  var coll = document.getElementsByClassName("collapsible");
  var i;

  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function () {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }



</script>
